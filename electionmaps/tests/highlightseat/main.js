/*! election_data 03-07-2015 */
function zoomMap(a){var b="#i"+a.properties.info_id;current=d3.select(b),current.attr("opacity",1),attrOpacities(.25,b);var c=path.bounds(a),d=Math.pow(c[1][0]-c[0][0],.5),e=Math.pow(c[1][1]-c[0][1],.5),f=(c[0][0]+c[1][0])/2,g=(c[0][1]+c[1][1])/2,h=.055/Math.max(d/width,e/height),i=[width/2-h*f,height/2-h*g];disableZoom(),svg.transition().duration(1500).call(zoom.translate(i).scale(h).event).each("end",enableZoom)}function attrOpacities(a,b){$.each(ids,function(c){ids[c]!=b&&d3.select(ids[c]).attr("opacity",a)})}function disableZoom(){svg.on("mousedown.zoom",null),svg.on("mousemove.zoom",null),svg.on("dblclick.zoom",null),svg.on("touchstart.zoom",null),svg.on("wheel.zoom",null),svg.on("mousewheel.zoom",null),svg.on("MozMousePixelScroll.zoom",null)}function enableZoom(){svg.call(zoom)}function reset(){disableZoom(),attrOpacities(1),svg.transition().duration(1500).call(zoom.translate([0,0]).scale(1).event).each("end",enableZoom)}function zoomed(){g.style("stroke-width",1.5/d3.event.scale+"px"),g.attr("transform","translate("+d3.event.translate+")scale("+d3.event.scale+")")}function stopped(){d3.event.defaultPrevented&&d3.event.stopPropagation()}function loadmap(){d3.json("data/mapwithinfo.json",function(a){g.selectAll(".map").data(topojson.feature(a,a.objects.map).features).enter().append("path").attr("fill",function(b){seatParty=a.objects.info[b.properties.name].seat_info.winning_party;var c=getStyleRuleValue("fill","."+seatParty);return c}).attr("class","map").attr("id",function(a){return"i"+a.properties.info_id}).attr("d",path).on("click",zoomMap).append("svg:title").text(function(a){return a.properties.info_id}).each(function(a){ids.push("#i"+a.properties.info_id)}),g.append("path").datum(topojson.mesh(a,a.objects.map,function(b,c){return a.objects.info[b.properties.name].seat_info.area!=a.objects.info[c.properties.name].seat_info.area&&b!=c})).attr("d",path).attr("class","boundaries")})}function getStyleRuleValue(a,b,c){for(var d="undefined"!=typeof c?[c]:document.styleSheets,e=0,f=d.length;f>e;e++){var c=d[e];if(c.cssRules)for(var g=0,h=c.cssRules.length;h>g;g++){var i=c.cssRules[g];if(i.selectorText&&-1!==i.selectorText.split(",").indexOf(b))return i.style[a]}}return null}var ids=[],current;loadmap();